<?php

/**
 * @file
 * Main finctions for booking calendar.
 */

/**
 * Implements hook_menu().
 */
function booking_calendar_menu() {
  $items['admin/config/content/booking_calendar'] = array(
    'page callback' => 'booking_calendar_admin_settings',
    'access arguments' => array('administer booking calendar'),
    'type' => MENU_CALLBACK,
  );
  $items['booking/calendar/ajax'] = array(
    'page callback' => 'booking_calendar_month_ajax',
    'access arguments' => array('administer booking calendar'),
    'type' => MENU_CALLBACK,
  );
  return $items;
}

/**
 * Implements hook_permission().
 */
function booking_calendar_permission() {
  return array(
    'administer booking calendar' => array(
      'title' => t('Administer the Booking Calendar'),
      'description' => t('Allow users use Booking Calendar'),
    ),
  );
}


/**
 * Implements hook_theme().
 */
function booking_calendar_theme($existing, $type, $theme, $path) {
  return array(
    'booking_calendar_admin' => array(
      'variables' => array(
        'week' => NULL,
        'month' => NULL,
        'year' => NULL,
      ),
    ),
    'booking_calendar_admin_table_day_hours' => array(
      'variables' => array(),
    ),
  );
}


/**
 * Defines form callback for the admin/config/availability-calendar/settings
 * page.
 */
function booking_calendar_admin_settings() {

  drupal_add_js(drupal_get_path('module', 'booking_calendar') . '/js/calendar.js');
  drupal_add_css(drupal_get_path('module', 'booking_calendar') . '/css/calendar.css');

  module_load_include('inc', 'booking_calendar', 'booking_calendar.ajax');
  module_load_include('inc', 'booking_calendar', 'booking_calendar.form');
  module_load_include('inc', 'booking_calendar', 'booking_calendar.theme');
  module_load_include('inc', 'booking_calendar', 'booking_calendar');


  $output = '';
  $output .= '<div id="t3"></div>';
  $output .= '<div class="flags">
                <ul>
                    <li class="this"><span class="av">' . t('Pasiekiamas') . '</span></li>
                    <li><span class="na">' . t('Pilnai nubaustas') . '</span></li>
                    <li><span class="opt">' . t('Pa≈°alinti nubaustas') . '</span></li>
                </ul>
            </div>';

  $output .= '<div id="calendar-wrapper">';
  $output .= theme('booking_calendar_admin', array('week' => _booking_calendar_calculate()));
  $output .= '</div>';

  $output .= theme('booking_calendar_admin_table_day_hours'/*, array('week' => _booking_calendar_calculate())*/);

  return $output;
}





